<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Masjid Mekarindah</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1B5E20;
            --primary-dark: #0D3D12;
            --primary-light: #4CAF50;
            --gold: #D4AF37;
            --white: #FFFFFF;
            --gray-light: #F5F5F5;
            --gray: #666666;
            --gray-dark: #333333;
            --danger: #E53935;
            --warning: #FF9800;
            --info: #2196F3;
            --sidebar-width: 260px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--gray-light);
            min-height: 100vh;
        }

        /* ============================================
           LOGIN SCREEN
        ============================================ */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-screen.hidden {
            display: none;
        }

        .login-box {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-box .logo {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }

        .login-box .logo i {
            font-size: 2.5rem;
            color: var(--gold);
        }

        .login-box h2 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .login-box p {
            color: var(--gray);
            margin-bottom: 30px;
        }

        .login-form .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-dark);
        }

        .login-form input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .login-form input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .login-form .btn-login {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .login-form .btn-login:hover {
            background: var(--primary-dark);
        }

        .login-error {
            background: #FFEBEE;
            color: var(--danger);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .login-error.show {
            display: block;
        }

        /* ============================================
           ADMIN LAYOUT
        ============================================ */
        .admin-container {
            display: none;
        }

        .admin-container.active {
            display: flex;
        }

        /* ============================================
           SIDEBAR
        ============================================ */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            min-height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 100;
            transition: transform 0.3s;
        }

        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header h2 {
            color: var(--white);
            font-size: 1.2rem;
        }

        .sidebar-header h2 i {
            color: var(--gold);
            margin-right: 10px;
        }

        .sidebar-header p {
            color: rgba(255,255,255,0.7);
            font-size: 0.85rem;
            margin-top: 5px;
        }

        .sidebar-menu {
            padding: 20px 0;
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 25px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(255,255,255,0.1);
            color: var(--white);
            border-left-color: var(--gold);
        }

        .sidebar-menu a i {
            width: 25px;
            margin-right: 10px;
        }

        .sidebar-menu .menu-divider {
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 15px 20px;
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-footer a {
            display: flex;
            align-items: center;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .sidebar-footer a:hover {
            background: rgba(255,255,255,0.1);
            color: var(--white);
        }

        .sidebar-footer a i {
            margin-right: 10px;
        }

        /* ============================================
           MAIN CONTENT
        ============================================ */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* ============================================
           HEADER
        ============================================ */
        .header {
            background: var(--white);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-dark);
            cursor: pointer;
        }

        .header h1 {
            font-size: 1.5rem;
            color: var(--gray-dark);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-right .btn-view-site {
            padding: 10px 20px;
            background: var(--primary);
            color: var(--white);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: background 0.3s;
        }

        .header-right .btn-view-site:hover {
            background: var(--primary-dark);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info .avatar {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
        }

        .user-info span {
            font-weight: 500;
            color: var(--gray-dark);
        }

        /* ============================================
           PAGE CONTENT
        ============================================ */
        .page-content {
            padding: 30px;
        }

        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* ============================================
           CARDS
        ============================================ */
        .card {
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 25px;
            overflow: hidden;
        }

        .card-header {
            padding: 20px 25px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            color: var(--gray-dark);
            font-size: 1.1rem;
        }

        .card-header h3 i {
            color: var(--primary);
            margin-right: 10px;
        }

        .card-body {
            padding: 25px;
        }

        /* ============================================
           STATS GRID (DASHBOARD)
        ============================================ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--white);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stat-card .icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-card .icon.green {
            background: rgba(76, 175, 80, 0.15);
            color: var(--primary);
        }

        .stat-card .icon.gold {
            background: rgba(212, 175, 55, 0.15);
            color: var(--gold);
        }

        .stat-card .icon.blue {
            background: rgba(33, 150, 243, 0.15);
            color: var(--info);
        }

        .stat-card .icon.orange {
            background: rgba(255, 152, 0, 0.15);
            color: var(--warning);
        }

        .stat-card .info h4 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .stat-card .info .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--gray-dark);
        }

        /* ============================================
           FORMS
        ============================================ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            color: var(--gray);
            font-size: 0.85rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        /* ============================================
           BUTTONS
        ============================================ */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--gray-light);
            color: var(--gray-dark);
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #C62828;
        }

        .btn-sm {
            padding: 8px 15px;
            font-size: 0.9rem;
        }

        .btn-icon {
            width: 35px;
            height: 35px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }

        /* ============================================
           TABLES
        ============================================ */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th,
        table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        table th {
            background: var(--gray-light);
            font-weight: 600;
            color: var(--gray-dark);
        }

        table tr:hover {
            background: #fafafa;
        }

        table .actions {
            display: flex;
            gap: 8px;
        }

        table img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(76, 175, 80, 0.15);
            color: var(--primary);
        }

        .badge-danger {
            background: rgba(229, 57, 53, 0.15);
            color: var(--danger);
        }

        .badge-warning {
            background: rgba(255, 152, 0, 0.15);
            color: var(--warning);
        }

        .badge-info {
            background: rgba(33, 150, 243, 0.15);
            color: var(--info);
        }

        /* ============================================
           MODAL
        ============================================ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 15px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: var(--gray-dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            padding: 15px 25px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* ============================================
           ALERTS / TOAST
        ============================================ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: var(--primary);
            color: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 2000;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--danger);
        }

        .toast.success {
            background: var(--primary);
        }

        /* ============================================
           LOADING
        ============================================ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #eee;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ============================================
           EMPTY STATE
        ============================================ */
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 20px;
        }

        .empty-state h4 {
            color: var(--gray-dark);
            margin-bottom: 10px;
        }

        /* ============================================
           RESPONSIVE
        ============================================ */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 99;
            }

            .sidebar-overlay.active {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.2rem;
            }

            .header-right .btn-view-site span {
                display: none;
            }

            .page-content {
                padding: 20px;
            }

            /* Mobile Table -> Cards */
            .mobile-cards table,
            .mobile-cards thead,
            .mobile-cards tbody,
            .mobile-cards th,
            .mobile-cards td,
            .mobile-cards tr {
                display: block;
            }

            .mobile-cards thead {
                display: none;
            }

            .mobile-cards tr {
                background: var(--white);
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 15px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            }

            .mobile-cards td {
                padding: 8px 0;
                border: none;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .mobile-cards td::before {
                content: attr(data-label);
                font-weight: 600;
                color: var(--gray);
            }

            .mobile-cards td:last-child {
                justify-content: flex-end;
            }

            .mobile-cards td:last-child::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- ============================================
         LOGIN SCREEN
    ============================================ -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="logo">
                <i class="fas fa-mosque"></i>
            </div>
            <h2>Admin Panel</h2>
            <p>Masjid Mekarindah</p>
            
            <div class="login-error" id="loginError">
                Username atau password salah!
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Masukkan username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Masukkan password" required>
                </div>
                <button type="submit" class="btn-login">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </form>
        </div>
    </div>

    <!-- ============================================
         ADMIN CONTAINER
    ============================================ -->
    <div class="admin-container" id="adminContainer">
        <!-- Sidebar Overlay (Mobile) -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- ============================================
             SIDEBAR
        ============================================ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-mosque"></i> Masjid Mekarindah</h2>
                <p>Admin Panel</p>
            </div>
            
            <ul class="sidebar-menu">
                <li>
                    <a href="#" class="active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="#" data-section="settings">
                        <i class="fas fa-cog"></i> Pengaturan
                    </a>
                </li>
                
                <div class="menu-divider"></div>
                
                <li>
                    <a href="#" data-section="jadwal">
                        <i class="fas fa-clock"></i> Jadwal Sholat
                    </a>
                </li>
                <li>
                    <a href="#" data-section="pengurus">
                        <i class="fas fa-users"></i> Pengurus
                    </a>
                </li>
                <li>
                    <a href="#" data-section="kajian">
                        <i class="fas fa-book-open"></i> Jadwal Kajian
                    </a>
                </li>
                
                <div class="menu-divider"></div>
                
                <li>
                    <a href="#" data-section="keuangan">
                        <i class="fas fa-wallet"></i> Keuangan
                    </a>
                </li>
                <li>
                    <a href="#" data-section="zakat">
                        <i class="fas fa-hand-holding-heart"></i> Zakat
                    </a>
                </li>
                
                <div class="menu-divider"></div>
                
                <li>
                    <a href="#" data-section="kisah">
                        <i class="fas fa-star"></i> Kisah Inspiratif
                    </a>
                </li>
                <li>
                    <a href="#" data-section="donasi">
                        <i class="fas fa-donate"></i> Donasi
                    </a>
                </li>
                <li>
                    <a href="#" data-section="galeri">
                        <i class="fas fa-images"></i> Galeri
                    </a>
                </li>
                <li>
                    <a href="#" data-section="pengumuman">
                        <i class="fas fa-bullhorn"></i> Pengumuman
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-footer">
                <a href="#" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </aside>

        <!-- ============================================
             MAIN CONTENT
        ============================================ -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle">Dashboard</h1>
                </div>
                <div class="header-right">
                    <a href="index.html" target="_blank" class="btn-view-site">
                        <i class="fas fa-external-link-alt"></i>
                        <span>Lihat Website</span>
                    </a>
                    <div class="user-info">
                        <div class="avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <span>Admin</span>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <!-- ============================================
                     SECTION: DASHBOARD
                ============================================ -->
                <section class="page-section active" id="sectionDashboard">
                    <!-- Stats Grid -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="icon green">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="info">
                                <h4>Saldo Kas</h4>
                                <div class="value" id="statSaldoKas">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon gold">
                                <i class="fas fa-hand-holding-heart"></i>
                            </div>
                            <div class="info">
                                <h4>Saldo Zakat</h4>
                                <div class="value" id="statSaldoZakat">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon blue">
                                <i class="fas fa-images"></i>
                            </div>
                            <div class="info">
                                <h4>Total Galeri</h4>
                                <div class="value" id="statGaleri">0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon orange">
                                <i class="fas fa-bullhorn"></i>
                            </div>
                            <div class="info">
                                <h4>Pengumuman</h4>
                                <div class="value" id="statPengumuman">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Info Cards -->
                    <div class="form-row">
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-line"></i> Ringkasan Keuangan</h3>
                            </div>
                            <div class="card-body">
                                <div class="stats-grid" style="grid-template-columns: repeat(2, 1fr);">
                                    <div class="stat-card" style="box-shadow: none; background: var(--gray-light);">
                                        <div class="icon green">
                                            <i class="fas fa-arrow-up"></i>
                                        </div>
                                        <div class="info">
                                            <h4>Pemasukan Bulan Ini</h4>
                                            <div class="value" id="statPemasukan" style="font-size: 1.3rem;">Rp 0</div>
                                        </div>
                                    </div>
                                    <div class="stat-card" style="box-shadow: none; background: var(--gray-light);">
                                        <div class="icon" style="background: rgba(229,57,53,0.15); color: var(--danger);">
                                            <i class="fas fa-arrow-down"></i>
                                        </div>
                                        <div class="info">
                                            <h4>Pengeluaran Bulan Ini</h4>
                                            <div class="value" id="statPengeluaran" style="font-size: 1.3rem;">Rp 0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-info-circle"></i> Info Masjid</h3>
                            </div>
                            <div class="card-body">
                                <p style="margin-bottom: 10px;"><strong>Nama:</strong> <span id="infoNama">Masjid Mekarindah</span></p>
                                <p style="margin-bottom: 10px;"><strong>Alamat:</strong> <span id="infoAlamat">-</span></p>
                                <p style="margin-bottom: 10px;"><strong>Jumlah Pengurus:</strong> <span id="infoPengurus">0</span> orang</p>
                                <p><strong>Kajian Aktif:</strong> <span id="infoKajian">0</span> jadwal</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Transaksi Terakhir</h3>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Keterangan</th>
                                            <th>Jenis</th>
                                            <th>Jumlah</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recentTransactions">
                                        <tr>
                                            <td colspan="4" style="text-align: center; color: var(--gray);">Belum ada transaksi</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: PENGATURAN
                ============================================ -->
                <section class="page-section" id="sectionSettings">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-cog"></i> Pengaturan Masjid</h3>
                        </div>
                        <div class="card-body">
                            <form id="settingsForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="setNamaMasjid">Nama Masjid</label>
                                        <input type="text" id="setNamaMasjid" placeholder="Nama Masjid">
                                    </div>
                                    <div class="form-group">
                                        <label for="setFotoMasjid">URL Foto Masjid</label>
                                        <input type="url" id="setFotoMasjid" placeholder="https://...">
                                        <small>Upload foto ke imgbb.com, paste Direct Link di sini</small>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="setAlamat">Alamat</label>
                                    <input type="text" id="setAlamat" placeholder="Alamat lengkap masjid">
                                </div>

                                <div class="form-group">
                                    <label for="setDeskripsi">Deskripsi Masjid</label>
                                    <textarea id="setDeskripsi" placeholder="Deskripsi singkat tentang masjid"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="setVisi">Visi</label>
                                    <textarea id="setVisi" placeholder="Visi masjid"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="setMisi">Misi (pisahkan dengan Enter)</label>
                                    <textarea id="setMisi" placeholder="Misi 1&#10;Misi 2&#10;Misi 3"></textarea>
                                    <small>Tulis setiap misi di baris baru</small>
                                </div>

                                <hr style="margin: 30px 0; border: none; border-top: 1px solid #eee;">

                                <h4 style="margin-bottom: 20px; color: var(--gray-dark);"><i class="fas fa-share-alt" style="color: var(--primary); margin-right: 10px;"></i> Sosial Media</h4>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="setFacebook"><i class="fab fa-facebook" style="color: #1877F2;"></i> Facebook URL</label>
                                        <input type="url" id="setFacebook" placeholder="https://facebook.com/...">
                                    </div>
                                    <div class="form-group">
                                        <label for="setInstagram"><i class="fab fa-instagram" style="color: #E4405F;"></i> Instagram URL</label>
                                        <input type="url" id="setInstagram" placeholder="https://instagram.com/...">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="setYoutube"><i class="fab fa-youtube" style="color: #FF0000;"></i> YouTube URL</label>
                                        <input type="url" id="setYoutube" placeholder="https://youtube.com/...">
                                    </div>
                                    <div class="form-group">
                                        <label for="setWhatsapp"><i class="fab fa-whatsapp" style="color: #25D366;"></i> WhatsApp Number</label>
                                        <input type="text" id="setWhatsapp" placeholder="6281234567890">
                                        <small>Format: 628xxx (tanpa + atau spasi)</small>
                                    </div>
                                </div>

                                <div style="margin-top: 20px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Simpan Pengaturan
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: JADWAL SHOLAT
                ============================================ -->
                <section class="page-section" id="sectionJadwal">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-clock"></i> Jadwal Sholat (Backup Manual)</h3>
                        </div>
                        <div class="card-body">
                            <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; margin-bottom: 25px;">
                                <p style="color: #1565C0;">
                                    <i class="fas fa-info-circle"></i> 
                                    Jadwal sholat otomatis diambil dari API Aladhan. 
                                    Data di bawah ini hanya sebagai backup jika API tidak tersedia.
                                </p>
                            </div>

                            <form id="jadwalForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="jadwalSubuh"><i class="fas fa-sun" style="color: var(--gold);"></i> Subuh</label>
                                        <input type="time" id="jadwalSubuh">
                                    </div>
                                    <div class="form-group">
                                        <label for="jadwalDzuhur"><i class="fas fa-sun" style="color: var(--warning);"></i> Dzuhur</label>
                                        <input type="time" id="jadwalDzuhur">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="jadwalAshar"><i class="fas fa-cloud-sun" style="color: var(--warning);"></i> Ashar</label>
                                        <input type="time" id="jadwalAshar">
                                    </div>
                                    <div class="form-group">
                                        <label for="jadwalMaghrib"><i class="fas fa-moon" style="color: var(--info);"></i> Maghrib</label>
                                        <input type="time" id="jadwalMaghrib">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="jadwalIsya"><i class="fas fa-star" style="color: var(--primary);"></i> Isya</label>
                                        <input type="time" id="jadwalIsya">
                                    </div>
                                    <div class="form-group">
                                        <!-- Empty for alignment -->
                                    </div>
                                </div>

                                <div style="margin-top: 20px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Simpan Jadwal
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: PENGURUS
                ============================================ -->
                <section class="page-section" id="sectionPengurus">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-users"></i> Daftar Pengurus</h3>
                            <button class="btn btn-primary btn-sm" onclick="openPengurusModal()">
                                <i class="fas fa-plus"></i> Tambah Pengurus
                            </button>
                        </div>
                        <div class="card-body">
                            <!-- Filter Tabs -->
                            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                                <button class="btn btn-sm btn-primary pengurus-filter active" data-filter="all">Semua</button>
                                <button class="btn btn-sm btn-secondary pengurus-filter" data-filter="Yayasan">Yayasan</button>
                                <button class="btn btn-sm btn-secondary pengurus-filter" data-filter="DKM">DKM</button>
                                <button class="btn btn-sm btn-secondary pengurus-filter" data-filter="Majlis Ta'lim">Majlis Ta'lim</button>
                            </div>

                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Foto</th>
                                            <th>Nama</th>
                                            <th>Jabatan</th>
                                            <th>Kategori</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pengurusTable">
                                        <tr>
                                            <td colspan="5">
                                                <div class="empty-state">
                                                    <i class="fas fa-users"></i>
                                                    <h4>Belum ada data pengurus</h4>
                                                    <p>Klik tombol "Tambah Pengurus" untuk menambahkan.</p>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: JADWAL KAJIAN
                ============================================ -->
                <section class="page-section" id="sectionKajian">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-book-open"></i> Jadwal Kajian Mingguan</h3>
                        </div>
                        <div class="card-body">
                            <form id="kajianForm">
                                <!-- Senin -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Senin</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianSeninNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianSeninWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianSeninPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianSeninVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianSeninAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Selasa -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Selasa</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianSelasaNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianSelasaWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianSelasaPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianSelasaVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianSelasaAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Rabu -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Rabu</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianRabuNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianRabuWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianRabuPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianRabuVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianRabuAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Kamis -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Kamis</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianKamisNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianKamisWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianKamisPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianKamisVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianKamisAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Jumat -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Jumat</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianJumatNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianJumatWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianJumatPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianJumatVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianJumatAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Sabtu -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Sabtu</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianSabtuNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianSabtuWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianSabtuPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianSabtuVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianSabtuAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Ahad -->
                                <div class="card" style="background: var(--gray-light); box-shadow: none; margin-bottom: 15px;">
                                    <div class="card-header" style="background: var(--primary); color: white; padding: 12px 20px;">
                                        <h3 style="color: white; font-size: 1rem;"><i class="fas fa-calendar-day"></i> Ahad</h3>
                                    </div>
                                    <div class="card-body" style="padding: 20px;">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nama Kajian</label>
                                                <input type="text" id="kajianAhadNama" placeholder="Nama kajian">
                                            </div>
                                            <div class="form-group">
                                                <label>Waktu</label>
                                                <input type="text" id="kajianAhadWaktu" placeholder="Contoh: Ba'da Maghrib">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Pemateri</label>
                                                <input type="text" id="kajianAhadPemateri" placeholder="Nama ustadz/pemateri">
                                            </div>
                                            <div class="form-group">
                                                <label>Link Video (YouTube)</label>
                                                <input type="url" id="kajianAhadVideo" placeholder="https://youtube.com/...">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Link Audio</label>
                                            <input type="url" id="kajianAhadAudio" placeholder="https://...">
                                        </div>
                                    </div>
                                </div>

                                <div style="margin-top: 20px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Simpan Semua Jadwal Kajian
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
                <!-- ============================================
                     SECTION: KEUANGAN
                ============================================ -->
                <section class="page-section" id="sectionKeuangan">
                    <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="stat-card">
                            <div class="icon green">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="info">
                                <h4>Saldo Saat Ini</h4>
                                <div class="value" id="keuanganSaldo">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon blue">
                                <i class="fas fa-arrow-up"></i>
                            </div>
                            <div class="info">
                                <h4>Total Pemasukan</h4>
                                <div class="value" id="keuanganPemasukan" style="color: var(--primary);">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon orange">
                                <i class="fas fa-arrow-down"></i>
                            </div>
                            <div class="info">
                                <h4>Total Pengeluaran</h4>
                                <div class="value" id="keuanganPengeluaran" style="color: var(--danger);">Rp 0</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-cog"></i> Saldo Awal</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="keuanganSaldoAwal">Saldo Awal Kas</label>
                                    <input type="number" id="keuanganSaldoAwal" placeholder="0">
                                    <small>Saldo awal sebelum ada transaksi tercatat</small>
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn btn-primary" onclick="simpanSaldoAwalKeuangan()">
                                        <i class="fas fa-save"></i> Simpan Saldo Awal
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-list"></i> Daftar Transaksi</h3>
                            <button class="btn btn-primary btn-sm" onclick="openKeuanganModal()">
                                <i class="fas fa-plus"></i> Tambah Transaksi
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Keterangan</th>
                                            <th>Jenis</th>
                                            <th>Jumlah</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="keuanganTable">
                                        <tr>
                                            <td colspan="5">
                                                <div class="empty-state">
                                                    <i class="fas fa-receipt"></i>
                                                    <h4>Belum ada transaksi</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: ZAKAT
                ============================================ -->
                <section class="page-section" id="sectionZakat">
                    <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="stat-card">
                            <div class="icon gold">
                                <i class="fas fa-hand-holding-heart"></i>
                            </div>
                            <div class="info">
                                <h4>Saldo Zakat</h4>
                                <div class="value" id="zakatSaldo">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon blue">
                                <i class="fas fa-arrow-up"></i>
                            </div>
                            <div class="info">
                                <h4>Zakat Masuk</h4>
                                <div class="value" id="zakatMasuk" style="color: var(--primary);">Rp 0</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="icon orange">
                                <i class="fas fa-arrow-down"></i>
                            </div>
                            <div class="info">
                                <h4>Zakat Tersalur</h4>
                                <div class="value" id="zakatKeluar" style="color: var(--danger);">Rp 0</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-cog"></i> Saldo Awal Zakat</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="zakatSaldoAwal">Saldo Awal Zakat</label>
                                    <input type="number" id="zakatSaldoAwal" placeholder="0">
                                    <small>Saldo awal sebelum ada transaksi tercatat</small>
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn btn-primary" onclick="simpanSaldoAwalZakat()">
                                        <i class="fas fa-save"></i> Simpan Saldo Awal
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-list"></i> Daftar Transaksi Zakat</h3>
                            <button class="btn btn-primary btn-sm" onclick="openZakatModal()">
                                <i class="fas fa-plus"></i> Tambah Transaksi
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Keterangan</th>
                                            <th>Jenis</th>
                                            <th>Jumlah</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="zakatTable">
                                        <tr>
                                            <td colspan="5">
                                                <div class="empty-state">
                                                    <i class="fas fa-hand-holding-heart"></i>
                                                    <h4>Belum ada transaksi zakat</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: KISAH INSPIRATIF
                ============================================ -->
                <section class="page-section" id="sectionKisah">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-star"></i> Kisah Inspiratif</h3>
                            <button class="btn btn-primary btn-sm" onclick="openKisahModal()">
                                <i class="fas fa-plus"></i> Tambah Kisah
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Gambar</th>
                                            <th>Judul</th>
                                            <th>Isi (Preview)</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="kisahTable">
                                        <tr>
                                            <td colspan="4">
                                                <div class="empty-state">
                                                    <i class="fas fa-star"></i>
                                                    <h4>Belum ada kisah inspiratif</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: DONASI
                ============================================ -->
                <section class="page-section" id="sectionDonasi">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-donate"></i> Rekening Donasi</h3>
                            <button class="btn btn-primary btn-sm" onclick="openDonasiModal()">
                                <i class="fas fa-plus"></i> Tambah Rekening
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Bank</th>
                                            <th>No. Rekening</th>
                                            <th>Atas Nama</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="donasiTable">
                                        <tr>
                                            <td colspan="4">
                                                <div class="empty-state">
                                                    <i class="fas fa-university"></i>
                                                    <h4>Belum ada rekening donasi</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: GALERI
                ============================================ -->
                <section class="page-section" id="sectionGaleri">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-images"></i> Galeri Kegiatan</h3>
                            <button class="btn btn-primary btn-sm" onclick="openGaleriModal()">
                                <i class="fas fa-plus"></i> Tambah Media
                            </button>
                        </div>
                        <div class="card-body">
                            <div style="background: #E8F5E9; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                                <p style="color: var(--primary); margin: 0;">
                                    <i class="fas fa-info-circle"></i> 
                                    <strong>Platform yang didukung:</strong> Foto (URL langsung), YouTube, Instagram, TikTok
                                </p>
                            </div>
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Preview</th>
                                            <th>Tipe</th>
                                            <th>Caption</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="galeriTable">
                                        <tr>
                                            <td colspan="4">
                                                <div class="empty-state">
                                                    <i class="fas fa-images"></i>
                                                    <h4>Belum ada foto/video di galeri</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================
                     SECTION: PENGUMUMAN
                ============================================ -->
                <section class="page-section" id="sectionPengumuman">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-bullhorn"></i> Pengumuman</h3>
                            <button class="btn btn-primary btn-sm" onclick="openPengumumanModal()">
                                <i class="fas fa-plus"></i> Tambah Pengumuman
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container mobile-cards">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Judul</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pengumumanTable">
                                        <tr>
                                            <td colspan="4">
                                                <div class="empty-state">
                                                    <i class="fas fa-bullhorn"></i>
                                                    <h4>Belum ada pengumuman</h4>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

            </div><!-- End Page Content -->
        </main><!-- End Main Content -->
    </div><!-- End Admin Container -->

    <!-- ============================================
         MODAL: PENGURUS
    ============================================ -->
    <div class="modal" id="modalPengurus">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalPengurusTitle">Tambah Pengurus</h3>
                <button class="modal-close" onclick="closeModal('modalPengurus')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formPengurus">
                    <input type="hidden" id="pengurusIndex" value="-1">
                    <div class="form-group">
                        <label for="pengurusNama">Nama Lengkap *</label>
                        <input type="text" id="pengurusNama" required placeholder="Nama pengurus">
                    </div>
                    <div class="form-group">
                        <label for="pengurusJabatan">Jabatan *</label>
                        <input type="text" id="pengurusJabatan" required placeholder="Contoh: Ketua DKM">
                    </div>
                    <div class="form-group">
                        <label for="pengurusKategori">Kategori *</label>
                        <select id="pengurusKategori" required>
                            <option value="">-- Pilih Kategori --</option>
                            <option value="Yayasan">Yayasan</option>
                            <option value="DKM">DKM</option>
                            <option value="Majlis Ta'lim">Majlis Ta'lim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pengurusFoto">URL Foto</label>
                        <input type="url" id="pengurusFoto" placeholder="https://i.ibb.co/...">
                        <small>Upload foto ke imgbb.com, paste Direct Link di sini</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalPengurus')">Batal</button>
                <button class="btn btn-primary" onclick="simpanPengurus()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: KEUANGAN
    ============================================ -->
    <div class="modal" id="modalKeuangan">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalKeuanganTitle">Tambah Transaksi</h3>
                <button class="modal-close" onclick="closeModal('modalKeuangan')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formKeuangan">
                    <input type="hidden" id="keuanganIndex" value="-1">
                    <div class="form-group">
                        <label for="keuanganTanggal">Tanggal *</label>
                        <input type="date" id="keuanganTanggal" required>
                    </div>
                    <div class="form-group">
                        <label for="keuanganJenis">Jenis *</label>
                        <select id="keuanganJenis" required>
                            <option value="">-- Pilih Jenis --</option>
                            <option value="pemasukan">Pemasukan</option>
                            <option value="pengeluaran">Pengeluaran</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="keuanganJumlah">Jumlah (Rp) *</label>
                        <input type="number" id="keuanganJumlah" required placeholder="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="keuanganKeterangan">Keterangan *</label>
                        <textarea id="keuanganKeterangan" required placeholder="Keterangan transaksi"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalKeuangan')">Batal</button>
                <button class="btn btn-primary" onclick="simpanKeuangan()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: ZAKAT
    ============================================ -->
    <div class="modal" id="modalZakat">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalZakatTitle">Tambah Transaksi Zakat</h3>
                <button class="modal-close" onclick="closeModal('modalZakat')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formZakat">
                    <input type="hidden" id="zakatIndex" value="-1">
                    <div class="form-group">
                        <label for="zakatTanggal">Tanggal *</label>
                        <input type="date" id="zakatTanggal" required>
                    </div>
                    <div class="form-group">
                        <label for="zakatJenis">Jenis *</label>
                        <select id="zakatJenis" required>
                            <option value="">-- Pilih Jenis --</option>
                            <option value="pemasukan">Zakat Masuk</option>
                            <option value="pengeluaran">Zakat Tersalur</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="zakatJumlah">Jumlah (Rp) *</label>
                        <input type="number" id="zakatJumlah" required placeholder="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="zakatKeterangan">Keterangan *</label>
                        <textarea id="zakatKeterangan" required placeholder="Keterangan transaksi zakat"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalZakat')">Batal</button>
                <button class="btn btn-primary" onclick="simpanZakat()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: KISAH INSPIRATIF
    ============================================ -->
    <div class="modal" id="modalKisah">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalKisahTitle">Tambah Kisah Inspiratif</h3>
                <button class="modal-close" onclick="closeModal('modalKisah')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formKisah">
                    <input type="hidden" id="kisahIndex" value="-1">
                    <div class="form-group">
                        <label for="kisahJudul">Judul *</label>
                        <input type="text" id="kisahJudul" required placeholder="Judul kisah">
                    </div>
                    <div class="form-group">
                        <label for="kisahGambar">URL Gambar</label>
                        <input type="url" id="kisahGambar" placeholder="https://i.ibb.co/...">
                        <small>Upload gambar ke imgbb.com, paste Direct Link di sini</small>
                    </div>
                    <div class="form-group">
                        <label for="kisahIsi">Isi Kisah *</label>
                        <textarea id="kisahIsi" required placeholder="Tulis isi kisah di sini..." style="min-height: 200px;"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalKisah')">Batal</button>
                <button class="btn btn-primary" onclick="simpanKisah()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: DONASI
    ============================================ -->
    <div class="modal" id="modalDonasi">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalDonasiTitle">Tambah Rekening Donasi</h3>
                <button class="modal-close" onclick="closeModal('modalDonasi')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formDonasi">
                    <input type="hidden" id="donasiIndex" value="-1">
                    <div class="form-group">
                        <label for="donasiBank">Nama Bank *</label>
                        <input type="text" id="donasiBank" required placeholder="Contoh: BSI, BCA, Mandiri">
                    </div>
                    <div class="form-group">
                        <label for="donasiNoRek">Nomor Rekening *</label>
                        <input type="text" id="donasiNoRek" required placeholder="1234567890">
                    </div>
                    <div class="form-group">
                        <label for="donasiAtasNama">Atas Nama *</label>
                        <input type="text" id="donasiAtasNama" required placeholder="Nama pemilik rekening">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalDonasi')">Batal</button>
                <button class="btn btn-primary" onclick="simpanDonasi()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: GALERI
    ============================================ -->
    <div class="modal" id="modalGaleri">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalGaleriTitle">Tambah Media</h3>
                <button class="modal-close" onclick="closeModal('modalGaleri')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formGaleri">
                    <input type="hidden" id="galeriIndex" value="-1">
                    <div class="form-group">
                        <label for="galeriTipe">Tipe Media *</label>
                        <select id="galeriTipe" required onchange="onGaleriTipeChange()">
                            <option value="">-- Pilih Tipe --</option>
                            <option value="foto"> Foto</option>
                            <option value="youtube"> YouTube</option>
                            <option value="instagram"> Instagram</option>
                            <option value="tiktok"> TikTok</option>
                        </select>
                    </div>
                    <div class="form-group" id="galeriUrlGroup">
                        <label for="galeriUrl" id="galeriUrlLabel">URL *</label>
                        <input type="url" id="galeriUrl" required placeholder="https://...">
                        <small id="galeriUrlHint">Masukkan URL media</small>
                    </div>
                    <div class="form-group">
                        <label for="galeriCaption">Caption</label>
                        <input type="text" id="galeriCaption" placeholder="Keterangan foto/video">
                    </div>

                    <!-- Preview Area -->
                    <div id="galeriPreview" style="margin-top: 15px; display: none;">
                        <label>Preview:</label>
                        <div id="galeriPreviewContent" style="margin-top: 10px; padding: 15px; background: var(--gray-light); border-radius: 10px; text-align: center;"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalGaleri')">Batal</button>
                <button class="btn btn-primary" onclick="simpanGaleri()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: PENGUMUMAN
    ============================================ -->
    <div class="modal" id="modalPengumuman">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalPengumumanTitle">Tambah Pengumuman</h3>
                <button class="modal-close" onclick="closeModal('modalPengumuman')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formPengumuman">
                    <input type="hidden" id="pengumumanIndex" value="-1">
                    <div class="form-group">
                        <label for="pengumumanTanggal">Tanggal *</label>
                        <input type="date" id="pengumumanTanggal" required>
                    </div>
                    <div class="form-group">
                        <label for="pengumumanJudul">Judul *</label>
                        <input type="text" id="pengumumanJudul" required placeholder="Judul pengumuman">
                    </div>
                    <div class="form-group">
                        <label for="pengumumanIsi">Isi Pengumuman *</label>
                        <textarea id="pengumumanIsi" required placeholder="Isi pengumuman..." style="min-height: 150px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="pengumumanPenting" style="width: auto;">
                            <span>Tandai sebagai PENTING</span>
                        </label>
                        <small>Pengumuman penting akan ditampilkan dengan badge merah</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalPengumuman')">Batal</button>
                <button class="btn btn-primary" onclick="simpanPengumuman()">
                    <i class="fas fa-save"></i> Simpan
                </button>
            </div>
        </div>
    </div>
    <!-- ============================================
         JAVASCRIPT
    ============================================ -->
    <script>
        // ============================================
        // KONFIGURASI DATABASE
        // ============================================
        const CONFIG = {
            BIN_ID: '695efa2343b1c97be920910e',
            API_KEY: '$2a$10$mu94DGoU.bNfbEUgWcjffueeAaIQfeb2hMzp.TM.Tg6M8JiaUOIVm',
            USERNAME: 'admin',
            PASSWORD: 'mekarindah2025'
        };

        // ============================================
        // VARIABEL GLOBAL
        // ============================================
        let appData = null;
        let deleteCallback = null;

        // ============================================
        // INISIALISASI
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            checkLogin();
            initNavigation();
            initForms();
        });

        // ============================================
        // LOGIN SYSTEM
        // ============================================
        function checkLogin() {
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn');
            if (isLoggedIn === 'true') {
                showAdminPanel();
            }
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === CONFIG.USERNAME && password === CONFIG.PASSWORD) {
                sessionStorage.setItem('adminLoggedIn', 'true');
                showAdminPanel();
            } else {
                document.getElementById('loginError').classList.add('show');
                setTimeout(() => {
                    document.getElementById('loginError').classList.remove('show');
                }, 3000);
            }
        });

        function showAdminPanel() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminContainer').classList.add('active');
            loadData();
        }

        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            sessionStorage.removeItem('adminLoggedIn');
            location.reload();
        });

        // ============================================
        // NAVIGASI & SIDEBAR
        // ============================================
        function initNavigation() {
            // Menu toggle (mobile)
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');

            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            });

            overlay.addEventListener('click', function() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            });

            // Sidebar menu navigation
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;

                    // Update active menu
                    document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');

                    // Show section
                    showSection(section);

                    // Update page title
                    const titles = {
                        'dashboard': 'Dashboard',
                        'settings': 'Pengaturan',
                        'jadwal': 'Jadwal Sholat',
                        'pengurus': 'Pengurus',
                        'kajian': 'Jadwal Kajian',
                        'keuangan': 'Keuangan',
                        'zakat': 'Zakat',
                        'kisah': 'Kisah Inspiratif',
                        'donasi': 'Donasi',
                        'galeri': 'Galeri',
                        'pengumuman': 'Pengumuman'
                    };
                    document.getElementById('pageTitle').textContent = titles[section];

                    // Close sidebar on mobile
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                });
            });

            // Pengurus filter
            document.querySelectorAll('.pengurus-filter').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.pengurus-filter').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('btn-secondary');
                    });
                    this.classList.remove('btn-secondary');
                    this.classList.add('btn-primary');
                    renderPengurusTable(this.dataset.filter);
                });
            });
        }

        function showSection(section) {
            document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
            const sectionId = 'section' + section.charAt(0).toUpperCase() + section.slice(1);
            const el = document.getElementById(sectionId);
            if (el) el.classList.add('active');
        }

        // ============================================
        // FORM INITIALIZATION
        // ============================================
        function initForms() {
            // Settings Form
            document.getElementById('settingsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                simpanSettings();
            });

            // Jadwal Form
            document.getElementById('jadwalForm').addEventListener('submit', function(e) {
                e.preventDefault();
                simpanJadwal();
            });

            // Kajian Form
            document.getElementById('kajianForm').addEventListener('submit', function(e) {
                e.preventDefault();
                simpanKajian();
            });

            // Set default date for transaksi
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) input.value = today;
            });
        }

        // ============================================
        // LOAD DATA DARI JSONBIN
        // ============================================
        async function loadData() {
            showLoading(true);
            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}/latest`, {
                    headers: {
                        'X-Master-Key': CONFIG.API_KEY
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    appData = result.record;
                    initializeDataStructure();
                    renderAllSections();
                } else {
                    throw new Error('Failed to load data');
                }
            } catch (error) {
                console.error('Error loading data:', error);
                showToast('Gagal memuat data. Membuat data baru...', 'error');
                appData = getDefaultData();
                await saveData();
                renderAllSections();
            }
            showLoading(false);
        }

        function getDefaultData() {
            return {
                settings: {
                    namaMasjid: 'Masjid Mekarindah',
                    alamat: 'Jalan Puspita II Blok L no.20, Mekarindah, Cikarang',
                    deskripsi: '',
                    visi: '',
                    misi: [],
                    fotoMasjid: '',
                    facebook: '',
                    instagram: '',
                    youtube: '',
                    whatsapp: ''
                },
                jadwalSholat: {
                    subuh: '04:30',
                    dzuhur: '12:00',
                    ashar: '15:15',
                    maghrib: '18:00',
                    isya: '19:15'
                },
                pengurus: [],
                jadwalKajian: {
                    senin: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    selasa: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    rabu: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    kamis: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    jumat: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    sabtu: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' },
                    ahad: { nama: '', waktu: '', pemateri: '', linkVideo: '', linkAudio: '' }
                },
                keuangan: { saldoAwal: 0, transaksi: [] },
                zakat: { saldoAwal: 0, transaksi: [] },
                kisahInspiratif: [],
                donasi: [],
                galeri: [],
                pengumuman: []
            };
        }

        function initializeDataStructure() {
            // Pastikan struktur data benar
            if (!appData.settings) appData.settings = getDefaultData().settings;
            if (!appData.jadwalSholat) appData.jadwalSholat = getDefaultData().jadwalSholat;
            if (!appData.pengurus) appData.pengurus = [];
            if (!appData.jadwalKajian) appData.jadwalKajian = getDefaultData().jadwalKajian;
            
            // Fix keuangan structure
            if (!appData.keuangan || Array.isArray(appData.keuangan)) {
                appData.keuangan = { saldoAwal: 0, transaksi: [] };
            }
            if (!appData.keuangan.transaksi) appData.keuangan.transaksi = [];
            
            // Fix zakat structure
            if (!appData.zakat || Array.isArray(appData.zakat)) {
                appData.zakat = { saldoAwal: 0, transaksi: [] };
            }
            if (!appData.zakat.transaksi) appData.zakat.transaksi = [];
            
            if (!appData.kisahInspiratif) appData.kisahInspiratif = [];
            if (!appData.donasi) appData.donasi = [];
            if (!appData.galeri) appData.galeri = [];
            if (!appData.pengumuman) appData.pengumuman = [];
        }

        // ============================================
        // SAVE DATA KE JSONBIN
        // ============================================
        async function saveData() {
            showLoading(true);
            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': CONFIG.API_KEY
                    },
                    body: JSON.stringify(appData)
                });

                if (response.ok) {
                    showToast('Data berhasil disimpan!', 'success');
                    return true;
                } else {
                    throw new Error('Failed to save');
                }
            } catch (error) {
                console.error('Error saving data:', error);
                showToast('Gagal menyimpan data!', 'error');
                return false;
            } finally {
                showLoading(false);
            }
        }

        // ============================================
        // RENDER ALL SECTIONS
        // ============================================
        function renderAllSections() {
            renderDashboard();
            renderSettingsForm();
            renderJadwalForm();
            renderPengurusTable();
            renderKajianForm();
            renderKeuanganSection();
            renderZakatSection();
            renderKisahTable();
            renderDonasiTable();
            renderGaleriTable();
            renderPengumumanTable();
        }

        // ============================================
        // DASHBOARD
        // ============================================
        function renderDashboard() {
            // Hitung saldo kas
            let saldoKas = appData.keuangan.saldoAwal ? appData.keuangan.saldoAwal : 0;
            let totalPemasukan = 0;
            let totalPengeluaran = 0;
            
            if (appData.keuangan.transaksi) {
                appData.keuangan.transaksi.forEach(t => {
                    if (t.jenis === 'pemasukan') {
                        totalPemasukan += t.jumlah;
                    } else {
                        totalPengeluaran += t.jumlah;
                    }
                });
            }
            saldoKas += totalPemasukan - totalPengeluaran;

            // Hitung saldo zakat
            let saldoZakat = appData.zakat.saldoAwal ? appData.zakat.saldoAwal : 0;
            if (appData.zakat.transaksi) {
                appData.zakat.transaksi.forEach(t => {
                    if (t.jenis === 'pemasukan') {
                        saldoZakat += t.jumlah;
                    } else {
                        saldoZakat -= t.jumlah;
                    }
                });
            }

            // Update stats
            document.getElementById('statSaldoKas').textContent = formatRupiah(saldoKas);
            document.getElementById('statSaldoZakat').textContent = formatRupiah(saldoZakat);
            document.getElementById('statGaleri').textContent = appData.galeri.length;
            document.getElementById('statPengumuman').textContent = appData.pengumuman.length;

            // Pemasukan/Pengeluaran bulan ini
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            
            let pemasukanBulanIni = 0;
            let pengeluaranBulanIni = 0;
            
            if (appData.keuangan.transaksi) {
                appData.keuangan.transaksi.forEach(t => {
                    const tDate = new Date(t.tanggal);
                    if (tDate.getMonth() === currentMonth && tDate.getFullYear() === currentYear) {
                        if (t.jenis === 'pemasukan') {
                            pemasukanBulanIni += t.jumlah;
                        } else {
                            pengeluaranBulanIni += t.jumlah;
                        }
                    }
                });
            }

            document.getElementById('statPemasukan').textContent = formatRupiah(pemasukanBulanIni);
            document.getElementById('statPengeluaran').textContent = formatRupiah(pengeluaranBulanIni);

            // Info masjid
            document.getElementById('infoNama').textContent = appData.settings.namaMasjid;
            document.getElementById('infoAlamat').textContent = appData.settings.alamat;
            document.getElementById('infoPengurus').textContent = appData.pengurus.length;
            
            let kajianAktif = 0;
            const hari = ['senin', 'selasa', 'rabu', 'kamis', 'jumat', 'sabtu', 'ahad'];
            hari.forEach(h => {
                if (appData.jadwalKajian[h] && appData.jadwalKajian[h].nama) {
                    kajianAktif++;
                }
            });
            document.getElementById('infoKajian').textContent = kajianAktif;

            // Recent transactions
            renderRecentTransactions();
        }

        function renderRecentTransactions() {
            const tbody = document.getElementById('recentTransactions');
            let allTrans = [];

            if (appData.keuangan.transaksi) {
                appData.keuangan.transaksi.forEach(t => {
                    allTrans.push({ ...t, kategori: 'Kas' });
                });
            }

            if (appData.zakat.transaksi) {
                appData.zakat.transaksi.forEach(t => {
                    allTrans.push({ ...t, kategori: 'Zakat' });
                });
            }

            // Sort by date descending
            allTrans.sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));

            // Take only 5 recent
            const recent = allTrans.slice(0, 5);

            if (recent.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--gray);">Belum ada transaksi</td></tr>';
                return;
            }

            tbody.innerHTML = recent.map(t => `
                <tr>
                    <td>${formatTanggal(t.tanggal)}</td>
                    <td>${t.keterangan} <small style="color:var(--gray);">(${t.kategori})</small></td>
                    <td>
                        <span class="badge ${t.jenis === 'pemasukan' ? 'badge-success' : 'badge-danger'}">
                            ${t.jenis === 'pemasukan' ? 'Masuk' : 'Keluar'}
                        </span>
                    </td>
                    <td style="color: ${t.jenis === 'pemasukan' ? 'var(--primary)' : 'var(--danger)'}; font-weight: 600;">
                        ${t.jenis === 'pemasukan' ? '+' : '-'}${formatRupiah(t.jumlah)}
                    </td>
                </tr>
            `).join('');
        }

        // ============================================
        // SETTINGS
        // ============================================
        function renderSettingsForm() {
            const s = appData.settings;
            document.getElementById('setNamaMasjid').value = s.namaMasjid;
            document.getElementById('setAlamat').value = s.alamat;
            document.getElementById('setDeskripsi').value = s.deskripsi;
            document.getElementById('setVisi').value = s.visi;
            document.getElementById('setMisi').value = s.misi ? s.misi.join('\n') : '';
            document.getElementById('setFotoMasjid').value = s.fotoMasjid;
            document.getElementById('setFacebook').value = s.facebook;
            document.getElementById('setInstagram').value = s.instagram;
            document.getElementById('setYoutube').value = s.youtube;
            document.getElementById('setWhatsapp').value = s.whatsapp;
        }

        async function simpanSettings() {
            appData.settings.namaMasjid = document.getElementById('setNamaMasjid').value;
            appData.settings.alamat = document.getElementById('setAlamat').value;
            appData.settings.deskripsi = document.getElementById('setDeskripsi').value;
            appData.settings.visi = document.getElementById('setVisi').value;
            
            const misiText = document.getElementById('setMisi').value;
            appData.settings.misi = misiText.split('\n').filter(m => m.trim() !== '');
            
            appData.settings.fotoMasjid = document.getElementById('setFotoMasjid').value;
            appData.settings.facebook = document.getElementById('setFacebook').value;
            appData.settings.instagram = document.getElementById('setInstagram').value;
            appData.settings.youtube = document.getElementById('setYoutube').value;
            appData.settings.whatsapp = document.getElementById('setWhatsapp').value;

            await saveData();
            renderDashboard();
        }

        // ============================================
        // JADWAL SHOLAT
        // ============================================
        function renderJadwalForm() {
            const j = appData.jadwalSholat;
            document.getElementById('jadwalSubuh').value = j.subuh;
            document.getElementById('jadwalDzuhur').value = j.dzuhur;
            document.getElementById('jadwalAshar').value = j.ashar;
            document.getElementById('jadwalMaghrib').value = j.maghrib;
            document.getElementById('jadwalIsya').value = j.isya;
        }

        async function simpanJadwal() {
            appData.jadwalSholat.subuh = document.getElementById('jadwalSubuh').value;
            appData.jadwalSholat.dzuhur = document.getElementById('jadwalDzuhur').value;
            appData.jadwalSholat.ashar = document.getElementById('jadwalAshar').value;
            appData.jadwalSholat.maghrib = document.getElementById('jadwalMaghrib').value;
            appData.jadwalSholat.isya = document.getElementById('jadwalIsya').value;
            await saveData();
        }

        // ============================================
        // PENGURUS
        // ============================================
        function renderPengurusTable(filter = 'all') {
            const tbody = document.getElementById('pengurusTable');
            let data = appData.pengurus;

            if (filter !== 'all') {
                data = data.filter(p => p.kategori === filter);
            }

            if (data.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <h4>Belum ada data pengurus</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = data.map((p, i) => {
                const realIndex = appData.pengurus.indexOf(p);
                return `
                    <tr>
                        <td data-label="Foto">
                            <img src="${p.foto ? p.foto : 'https://via.placeholder.com/50?text=Foto'}" alt="${p.nama}">
                        </td>
                        <td data-label="Nama">${p.nama}</td>
                        <td data-label="Jabatan">${p.jabatan}</td>
                        <td data-label="Kategori">
                            <span class="badge badge-info">${p.kategori}</span>
                        </td>
                        <td data-label="Aksi">
                            <div class="actions">
                                <button class="btn btn-icon btn-secondary" onclick="editPengurus(${realIndex})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-icon btn-danger" onclick="hapusPengurus(${realIndex})" title="Hapus">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function openPengurusModal(index = -1) {
            document.getElementById('pengurusIndex').value = index;
            document.getElementById('modalPengurusTitle').textContent = index === -1 ? 'Tambah Pengurus' : 'Edit Pengurus';
            
            if (index === -1) {
                document.getElementById('formPengurus').reset();
            } else {
                const p = appData.pengurus[index];
                document.getElementById('pengurusNama').value = p.nama;
                document.getElementById('pengurusJabatan').value = p.jabatan;
                document.getElementById('pengurusKategori').value = p.kategori;
                document.getElementById('pengurusFoto').value = p.foto;
            }
            
            openModal('modalPengurus');
        }

        function editPengurus(index) {
            openPengurusModal(index);
        }

        async function simpanPengurus() {
            const index = parseInt(document.getElementById('pengurusIndex').value);
            const pengurus = {
                nama: document.getElementById('pengurusNama').value,
                jabatan: document.getElementById('pengurusJabatan').value,
                kategori: document.getElementById('pengurusKategori').value,
                foto: document.getElementById('pengurusFoto').value
            };

            if (!pengurus.nama || !pengurus.jabatan || !pengurus.kategori) {
                showToast('Lengkapi semua field yang wajib!', 'error');
                return;
            }

            if (index === -1) {
                appData.pengurus.push(pengurus);
            } else {
                appData.pengurus[index] = pengurus;
            }

            await saveData();
            closeModal('modalPengurus');
            renderPengurusTable();
            renderDashboard();
        }

        function hapusPengurus(index) {
            konfirmasiHapus('pengurus ini', async () => {
                appData.pengurus.splice(index, 1);
                await saveData();
                renderPengurusTable();
                renderDashboard();
            });
        }

        // ============================================
        // JADWAL KAJIAN
        // ============================================
        function renderKajianForm() {
            const hari = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Ahad'];
            hari.forEach(h => {
                const key = h.toLowerCase();
                const k = appData.jadwalKajian[key];
                if (k) {
                    document.getElementById(`kajian${h}Nama`).value = k.nama;
                    document.getElementById(`kajian${h}Waktu`).value = k.waktu;
                    document.getElementById(`kajian${h}Pemateri`).value = k.pemateri;
                    document.getElementById(`kajian${h}Video`).value = k.linkVideo;
                    document.getElementById(`kajian${h}Audio`).value = k.linkAudio;
                }
            });
        }

        async function simpanKajian() {
            const hari = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Ahad'];
            hari.forEach(h => {
                const key = h.toLowerCase();
                appData.jadwalKajian[key] = {
                    nama: document.getElementById(`kajian${h}Nama`).value,
                    waktu: document.getElementById(`kajian${h}Waktu`).value,
                    pemateri: document.getElementById(`kajian${h}Pemateri`).value,
                    linkVideo: document.getElementById(`kajian${h}Video`).value,
                    linkAudio: document.getElementById(`kajian${h}Audio`).value
                };
            });
            await saveData();
            renderDashboard();
        }

        // ============================================
        // KEUANGAN
        // ============================================
        function renderKeuanganSection() {
            const k = appData.keuangan;
            const saldoAwal = k.saldoAwal ? k.saldoAwal : 0;
            
            let totalPemasukan = 0;
            let totalPengeluaran = 0;
            
            if (k.transaksi) {
                k.transaksi.forEach(t => {
                    if (t.jenis === 'pemasukan') {
                        totalPemasukan += t.jumlah;
                    } else {
                        totalPengeluaran += t.jumlah;
                    }
                });
            }

            const saldoAkhir = saldoAwal + totalPemasukan - totalPengeluaran;

            document.getElementById('keuanganSaldo').textContent = formatRupiah(saldoAkhir);
            document.getElementById('keuanganPemasukan').textContent = formatRupiah(totalPemasukan);
            document.getElementById('keuanganPengeluaran').textContent = formatRupiah(totalPengeluaran);
            document.getElementById('keuanganSaldoAwal').value = saldoAwal;

            renderKeuanganTable();
        }

        function renderKeuanganTable() {
            const tbody = document.getElementById('keuanganTable');
            const transaksi = appData.keuangan.transaksi;

            if (!transaksi || transaksi.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <i class="fas fa-receipt"></i>
                                <h4>Belum ada transaksi</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            // Sort by date descending
            const sorted = [...transaksi].sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));

            tbody.innerHTML = sorted.map((t, sortedIndex) => {
                const realIndex = transaksi.indexOf(t);
                return `
                    <tr>
                        <td data-label="Tanggal">${formatTanggal(t.tanggal)}</td>
                        <td data-label="Keterangan">${t.keterangan}</td>
                        <td data-label="Jenis">
                            <span class="badge ${t.jenis === 'pemasukan' ? 'badge-success' : 'badge-danger'}">
                                ${t.jenis === 'pemasukan' ? 'Pemasukan' : 'Pengeluaran'}
                            </span>
                        </td>
                        <td data-label="Jumlah" style="color: ${t.jenis === 'pemasukan' ? 'var(--primary)' : 'var(--danger)'}; font-weight: 600;">
                            ${t.jenis === 'pemasukan' ? '+' : '-'}${formatRupiah(t.jumlah)}
                        </td>
                        <td data-label="Aksi">
                            <div class="actions">
                                <button class="btn btn-icon btn-secondary" onclick="editKeuangan(${realIndex})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-icon btn-danger" onclick="hapusKeuangan(${realIndex})" title="Hapus">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        async function simpanSaldoAwalKeuangan() {
            appData.keuangan.saldoAwal = parseInt(document.getElementById('keuanganSaldoAwal').value) || 0;
            await saveData();
            renderKeuanganSection();
            renderDashboard();
        }

        function openKeuanganModal(index = -1) {
            document.getElementById('keuanganIndex').value = index;
            document.getElementById('modalKeuanganTitle').textContent = index === -1 ? 'Tambah Transaksi' : 'Edit Transaksi';
            
            if (index === -1) {
                document.getElementById('formKeuangan').reset();
                document.getElementById('keuanganTanggal').value = new Date().toISOString().split('T')[0];
            } else {
                const t = appData.keuangan.transaksi[index];
                document.getElementById('keuanganTanggal').value = t.tanggal;
                document.getElementById('keuanganJenis').value = t.jenis;
                document.getElementById('keuanganJumlah').value = t.jumlah;
                document.getElementById('keuanganKeterangan').value = t.keterangan;
            }
            
            openModal('modalKeuangan');
        }

        function editKeuangan(index) {
            openKeuanganModal(index);
        }

        async function simpanKeuangan() {
            const index = parseInt(document.getElementById('keuanganIndex').value);
            const transaksi = {
                tanggal: document.getElementById('keuanganTanggal').value,
                jenis: document.getElementById('keuanganJenis').value,
                jumlah: parseInt(document.getElementById('keuanganJumlah').value) || 0,
                keterangan: document.getElementById('keuanganKeterangan').value
            };

            if (!transaksi.tanggal || !transaksi.jenis || !transaksi.jumlah || !transaksi.keterangan) {
                showToast('Lengkapi semua field!', 'error');
                return;
            }

            if (index === -1) {
                appData.keuangan.transaksi.push(transaksi);
            } else {
                appData.keuangan.transaksi[index] = transaksi;
            }

            await saveData();
            closeModal('modalKeuangan');
            renderKeuanganSection();
            renderDashboard();
        }

        function hapusKeuangan(index) {
            konfirmasiHapus('transaksi ini', async () => {
                appData.keuangan.transaksi.splice(index, 1);
                await saveData();
                renderKeuanganSection();
                renderDashboard();
            });
        }

        // ============================================
        // ZAKAT
        // ============================================
        function renderZakatSection() {
            const z = appData.zakat;
            const saldoAwal = z.saldoAwal ? z.saldoAwal : 0;
            
            let totalMasuk = 0;
            let totalKeluar = 0;
            
            if (z.transaksi) {
                z.transaksi.forEach(t => {
                    if (t.jenis === 'pemasukan') {
                        totalMasuk += t.jumlah;
                    } else {
                        totalKeluar += t.jumlah;
                    }
                });
            }

            const saldoAkhir = saldoAwal + totalMasuk - totalKeluar;

            document.getElementById('zakatSaldo').textContent = formatRupiah(saldoAkhir);
            document.getElementById('zakatMasuk').textContent = formatRupiah(totalMasuk);
            document.getElementById('zakatKeluar').textContent = formatRupiah(totalKeluar);
            document.getElementById('zakatSaldoAwal').value = saldoAwal;

            renderZakatTable();
        }

        function renderZakatTable() {
            const tbody = document.getElementById('zakatTable');
            const transaksi = appData.zakat.transaksi;

            if (!transaksi || transaksi.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <i class="fas fa-hand-holding-heart"></i>
                                <h4>Belum ada transaksi zakat</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            const sorted = [...transaksi].sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));

            tbody.innerHTML = sorted.map((t, sortedIndex) => {
                const realIndex = transaksi.indexOf(t);
                return `
                    <tr>
                        <td data-label="Tanggal">${formatTanggal(t.tanggal)}</td>
                        <td data-label="Keterangan">${t.keterangan}</td>
                        <td data-label="Jenis">
                            <span class="badge ${t.jenis === 'pemasukan' ? 'badge-success' : 'badge-danger'}">
                                ${t.jenis === 'pemasukan' ? 'Masuk' : 'Tersalur'}
                            </span>
                        </td>
                        <td data-label="Jumlah" style="color: ${t.jenis === 'pemasukan' ? 'var(--primary)' : 'var(--danger)'}; font-weight: 600;">
                            ${t.jenis === 'pemasukan' ? '+' : '-'}${formatRupiah(t.jumlah)}
                        </td>
                        <td data-label="Aksi">
                            <div class="actions">
                                <button class="btn btn-icon btn-secondary" onclick="editZakat(${realIndex})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-icon btn-danger" onclick="hapusZakat(${realIndex})" title="Hapus">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        async function simpanSaldoAwalZakat() {
            appData.zakat.saldoAwal = parseInt(document.getElementById('zakatSaldoAwal').value) || 0;
            await saveData();
            renderZakatSection();
            renderDashboard();
        }

        function openZakatModal(index = -1) {
            document.getElementById('zakatIndex').value = index;
            document.getElementById('modalZakatTitle').textContent = index === -1 ? 'Tambah Transaksi Zakat' : 'Edit Transaksi Zakat';
            
            if (index === -1) {
                document.getElementById('formZakat').reset();
                document.getElementById('zakatTanggal').value = new Date().toISOString().split('T')[0];
            } else {
                const t = appData.zakat.transaksi[index];
                document.getElementById('zakatTanggal').value = t.tanggal;
                document.getElementById('zakatJenis').value = t.jenis;
                document.getElementById('zakatJumlah').value = t.jumlah;
                document.getElementById('zakatKeterangan').value = t.keterangan;
            }
            
            openModal('modalZakat');
        }

        function editZakat(index) {
            openZakatModal(index);
        }

        async function simpanZakat() {
            const index = parseInt(document.getElementById('zakatIndex').value);
            const transaksi = {
                tanggal: document.getElementById('zakatTanggal').value,
                jenis: document.getElementById('zakatJenis').value,
                jumlah: parseInt(document.getElementById('zakatJumlah').value) || 0,
                keterangan: document.getElementById('zakatKeterangan').value
            };

            if (!transaksi.tanggal || !transaksi.jenis || !transaksi.jumlah || !transaksi.keterangan) {
                showToast('Lengkapi semua field!', 'error');
                return;
            }

            if (index === -1) {
                appData.zakat.transaksi.push(transaksi);
            } else {
                appData.zakat.transaksi[index] = transaksi;
            }

            await saveData();
            closeModal('modalZakat');
            renderZakatSection();
            renderDashboard();
        }

        function hapusZakat(index) {
            konfirmasiHapus('transaksi zakat ini', async () => {
                appData.zakat.transaksi.splice(index, 1);
                await saveData();
                renderZakatSection();
                renderDashboard();
            });
        }

        // ============================================
        // KISAH INSPIRATIF
        // ============================================
        function renderKisahTable() {
            const tbody = document.getElementById('kisahTable');
            const kisah = appData.kisahInspiratif;

            if (!kisah || kisah.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4">
                            <div class="empty-state">
                                <i class="fas fa-star"></i>
                                <h4>Belum ada kisah inspiratif</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = kisah.map((k, i) => `
                <tr>
                    <td data-label="Gambar">
                        <img src="${k.gambar ? k.gambar : 'https://via.placeholder.com/50?text=Kisah'}" alt="${k.judul}">
                    </td>
                    <td data-label="Judul">${k.judul}</td>
                    <td data-label="Isi">${k.isi.substring(0, 80)}...</td>
                    <td data-label="Aksi">
                        <div class="actions">
                            <button class="btn btn-icon btn-secondary" onclick="editKisah(${i})" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-icon btn-danger" onclick="hapusKisah(${i})" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function openKisahModal(index = -1) {
            document.getElementById('kisahIndex').value = index;
            document.getElementById('modalKisahTitle').textContent = index === -1 ? 'Tambah Kisah Inspiratif' : 'Edit Kisah Inspiratif';
            
            if (index === -1) {
                document.getElementById('formKisah').reset();
            } else {
                const k = appData.kisahInspiratif[index];
                document.getElementById('kisahJudul').value = k.judul;
                document.getElementById('kisahGambar').value = k.gambar;
                document.getElementById('kisahIsi').value = k.isi;
            }
            
            openModal('modalKisah');
        }

        function editKisah(index) {
            openKisahModal(index);
        }

        async function simpanKisah() {
            const index = parseInt(document.getElementById('kisahIndex').value);
            const kisah = {
                judul: document.getElementById('kisahJudul').value,
                gambar: document.getElementById('kisahGambar').value,
                isi: document.getElementById('kisahIsi').value
            };

            if (!kisah.judul || !kisah.isi) {
                showToast('Lengkapi judul dan isi kisah!', 'error');
                return;
            }

            if (index === -1) {
                appData.kisahInspiratif.push(kisah);
            } else {
                appData.kisahInspiratif[index] = kisah;
            }

            await saveData();
            closeModal('modalKisah');
            renderKisahTable();
        }

        function hapusKisah(index) {
            konfirmasiHapus('kisah ini', async () => {
                appData.kisahInspiratif.splice(index, 1);
                await saveData();
                renderKisahTable();
            });
        }

        // ============================================
        // DONASI
        // ============================================
        function renderDonasiTable() {
            const tbody = document.getElementById('donasiTable');
            const donasi = appData.donasi;

            if (!donasi || donasi.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4">
                            <div class="empty-state">
                                <i class="fas fa-university"></i>
                                <h4>Belum ada rekening donasi</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = donasi.map((d, i) => `
                <tr>
                    <td data-label="Bank"><strong>${d.bank}</strong></td>
                    <td data-label="No. Rekening">${d.noRekening}</td>
                    <td data-label="Atas Nama">${d.atasNama}</td>
                    <td data-label="Aksi">
                        <div class="actions">
                            <button class="btn btn-icon btn-secondary" onclick="editDonasi(${i})" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-icon btn-danger" onclick="hapusDonasi(${i})" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function openDonasiModal(index = -1) {
            document.getElementById('donasiIndex').value = index;
            document.getElementById('modalDonasiTitle').textContent = index === -1 ? 'Tambah Rekening Donasi' : 'Edit Rekening Donasi';
            
            if (index === -1) {
                document.getElementById('formDonasi').reset();
            } else {
                const d = appData.donasi[index];
                document.getElementById('donasiBank').value = d.bank;
                document.getElementById('donasiNoRek').value = d.noRekening;
                document.getElementById('donasiAtasNama').value = d.atasNama;
            }
            
            openModal('modalDonasi');
        }

        function editDonasi(index) {
            openDonasiModal(index);
        }

        async function simpanDonasi() {
            const index = parseInt(document.getElementById('donasiIndex').value);
            const donasi = {
                bank: document.getElementById('donasiBank').value,
                noRekening: document.getElementById('donasiNoRek').value,
                atasNama: document.getElementById('donasiAtasNama').value
            };

            if (!donasi.bank || !donasi.noRekening || !donasi.atasNama) {
                showToast('Lengkapi semua field!', 'error');
                return;
            }

            if (index === -1) {
                appData.donasi.push(donasi);
            } else {
                appData.donasi[index] = donasi;
            }

            await saveData();
            closeModal('modalDonasi');
            renderDonasiTable();
        }

        function hapusDonasi(index) {
            konfirmasiHapus('rekening donasi ini', async () => {
                appData.donasi.splice(index, 1);
                await saveData();
                renderDonasiTable();
            });
        }

        // ============================================
        // GALERI
        // ============================================
        function renderGaleriTable() {
            const tbody = document.getElementById('galeriTable');
            const galeri = appData.galeri;

            if (!galeri || galeri.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4">
                            <div class="empty-state">
                                <i class="fas fa-images"></i>
                                <h4>Belum ada foto/video di galeri</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = galeri.map((g, i) => {
                let preview = '';
                let badge = '';

                if (g.tipe === 'foto') {
                    preview = `<img src="${g.url}" alt="Foto" style="width:80px; height:60px; object-fit:cover; border-radius:8px;">`;
                    badge = '<span class="badge badge-info"> Foto</span>';
                } else if (g.tipe === 'youtube') {
                    preview = `<img src="https://img.youtube.com/vi/${g.youtubeId}/default.jpg" alt="YouTube" style="width:80px; height:60px; object-fit:cover; border-radius:8px;">`;
                    badge = '<span class="badge badge-danger"> YouTube</span>';
                } else if (g.tipe === 'instagram') {
                    preview = `<div style="width:80px;height:60px;background:linear-gradient(45deg,#f09433,#dc2743,#bc1888);border-radius:8px;display:flex;align-items:center;justify-content:center;color:white;"><i class="fab fa-instagram fa-2x"></i></div>`;
                    badge = '<span class="badge badge-warning" style="background:#E4405F;color:white;"> Instagram</span>';
                } else if (g.tipe === 'tiktok') {
                    preview = `<div style="width:80px;height:60px;background:#000;border-radius:8px;display:flex;align-items:center;justify-content:center;color:white;"><i class="fab fa-tiktok fa-2x"></i></div>`;
                    badge = '<span class="badge" style="background:#000;color:white;"> TikTok</span>';
                }

                return `
                    <tr>
                        <td data-label="Preview">${preview}</td>
                        <td data-label="Tipe">${badge}</td>
                        <td data-label="Caption">${g.caption ? g.caption : '-'}</td>
                        <td data-label="Aksi">
                            <div class="actions">
                                <button class="btn btn-icon btn-secondary" onclick="editGaleri(${i})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-icon btn-danger" onclick="hapusGaleri(${i})" title="Hapus">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function onGaleriTipeChange() {
            const tipe = document.getElementById('galeriTipe').value;
            const urlLabel = document.getElementById('galeriUrlLabel');
            const urlHint = document.getElementById('galeriUrlHint');
            const urlInput = document.getElementById('galeriUrl');

            urlInput.value = '';
            document.getElementById('galeriPreview').style.display = 'none';

            if (tipe === 'foto') {
                urlLabel.textContent = 'URL Foto *';
                urlHint.textContent = 'Upload ke imgbb.com, paste Direct Link di sini';
                urlInput.placeholder = 'https://i.ibb.co/xxx/foto.jpg';
            } else if (tipe === 'youtube') {
                urlLabel.textContent = 'URL YouTube *';
                urlHint.textContent = 'Contoh: youtube.com/watch?v=xxx, youtu.be/xxx, youtube.com/shorts/xxx';
                urlInput.placeholder = 'https://www.youtube.com/watch?v=VIDEO_ID';
            } else if (tipe === 'instagram') {
                urlLabel.textContent = 'URL Instagram *';
                urlHint.textContent = 'Contoh: instagram.com/p/xxx/, instagram.com/reel/xxx/';
                urlInput.placeholder = 'https://www.instagram.com/p/POST_ID/';
            } else if (tipe === 'tiktok') {
                urlLabel.textContent = 'URL TikTok *';
                urlHint.textContent = 'Contoh: tiktok.com/@user/video/xxx, vm.tiktok.com/xxx';
                urlInput.placeholder = 'https://www.tiktok.com/@user/video/VIDEO_ID';
            }
        }

        function extractYouTubeId(url) {
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/shorts\/|youtube\.com\/live\/)([a-zA-Z0-9_-]{11})/,
                /^([a-zA-Z0-9_-]{11})$/
            ];
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        function extractInstagramId(url) {
            const patterns = [
                /instagram\.com\/(?:p|reel|reels)\/([a-zA-Z0-9_-]+)/
            ];
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        function extractTikTokId(url) {
            const patterns = [
                /tiktok\.com\/@[\w.-]+\/video\/(\d+)/,
                /vm\.tiktok\.com\/([a-zA-Z0-9]+)/,
                /tiktok\.com\/t\/([a-zA-Z0-9]+)/
            ];
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        function openGaleriModal(index = -1) {
            document.getElementById('galeriIndex').value = index;
            document.getElementById('modalGaleriTitle').textContent = index === -1 ? 'Tambah Media' : 'Edit Media';
            document.getElementById('galeriPreview').style.display = 'none';
            
            if (index === -1) {
                document.getElementById('formGaleri').reset();
                onGaleriTipeChange();
            } else {
                const g = appData.galeri[index];
                document.getElementById('galeriTipe').value = g.tipe;
                onGaleriTipeChange();
                
                if (g.tipe === 'foto') {
                    document.getElementById('galeriUrl').value = g.url;
                } else if (g.tipe === 'youtube') {
                    document.getElementById('galeriUrl').value = `https://www.youtube.com/watch?v=${g.youtubeId}`;
                } else if (g.tipe === 'instagram') {
                    document.getElementById('galeriUrl').value = g.instagramUrl;
                } else if (g.tipe === 'tiktok') {
                    document.getElementById('galeriUrl').value = g.tiktokUrl;
                }
                
                document.getElementById('galeriCaption').value = g.caption;
            }
            
            openModal('modalGaleri');
        }

        function editGaleri(index) {
            openGaleriModal(index);
        }

        async function simpanGaleri() {
            const index = parseInt(document.getElementById('galeriIndex').value);
            const tipe = document.getElementById('galeriTipe').value;
            const url = document.getElementById('galeriUrl').value;
            const caption = document.getElementById('galeriCaption').value;

            if (!tipe || !url) {
                showToast('Pilih tipe dan masukkan URL!', 'error');
                return;
            }

            let galeriItem = { tipe, caption };

            if (tipe === 'foto') {
                galeriItem.url = url;
            } else if (tipe === 'youtube') {
                const ytId = extractYouTubeId(url);
                if (!ytId) {
                    showToast('URL YouTube tidak valid!', 'error');
                    return;
                }
                galeriItem.youtubeId = ytId;
            } else if (tipe === 'instagram') {
                const igId = extractInstagramId(url);
                if (!igId) {
                    showToast('URL Instagram tidak valid!', 'error');
                    return;
                }
                galeriItem.instagramId = igId;
                galeriItem.instagramUrl = url;
            } else if (tipe === 'tiktok') {
                const ttId = extractTikTokId(url);
                if (!ttId) {
                    showToast('URL TikTok tidak valid!', 'error');
                    return;
                }
                galeriItem.tiktokId = ttId;
                galeriItem.tiktokUrl = url;
            }

            if (index === -1) {
                appData.galeri.push(galeriItem);
            } else {
                appData.galeri[index] = galeriItem;
            }

            await saveData();
            closeModal('modalGaleri');
            renderGaleriTable();
            renderDashboard();
        }

        function hapusGaleri(index) {
            konfirmasiHapus('media ini dari galeri', async () => {
                appData.galeri.splice(index, 1);
                await saveData();
                renderGaleriTable();
                renderDashboard();
            });
        }

        // ============================================
        // PENGUMUMAN
        // ============================================
        function renderPengumumanTable() {
            const tbody = document.getElementById('pengumumanTable');
            const pengumuman = appData.pengumuman;

            if (!pengumuman || pengumuman.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4">
                            <div class="empty-state">
                                <i class="fas fa-bullhorn"></i>
                                <h4>Belum ada pengumuman</h4>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            // Sort by date descending
            const sorted = [...pengumuman].sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));

            tbody.innerHTML = sorted.map((p, sortedIndex) => {
                const realIndex = pengumuman.indexOf(p);
                return `
                    <tr>
                        <td data-label="Tanggal">${formatTanggal(p.tanggal)}</td>
                        <td data-label="Judul">${p.judul}</td>
                        <td data-label="Status">
                            ${p.penting ? '<span class="badge badge-danger">PENTING</span>' : '<span class="badge badge-info">Normal</span>'}
                        </td>
                        <td data-label="Aksi">
                            <div class="actions">
                                <button class="btn btn-icon btn-secondary" onclick="editPengumuman(${realIndex})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-icon btn-danger" onclick="hapusPengumuman(${realIndex})" title="Hapus">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function openPengumumanModal(index = -1) {
            document.getElementById('pengumumanIndex').value = index;
            document.getElementById('modalPengumumanTitle').textContent = index === -1 ? 'Tambah Pengumuman' : 'Edit Pengumuman';
            
            if (index === -1) {
                document.getElementById('formPengumuman').reset();
                document.getElementById('pengumumanTanggal').value = new Date().toISOString().split('T')[0];
            } else {
                const p = appData.pengumuman[index];
                document.getElementById('pengumumanTanggal').value = p.tanggal;
                document.getElementById('pengumumanJudul').value = p.judul;
                document.getElementById('pengumumanIsi').value = p.isi;
                document.getElementById('pengumumanPenting').checked = p.penting;
            }
            
            openModal('modalPengumuman');
        }

        function editPengumuman(index) {
            openPengumumanModal(index);
        }

        async function simpanPengumuman() {
            const index = parseInt(document.getElementById('pengumumanIndex').value);
            const pengumuman = {
                tanggal: document.getElementById('pengumumanTanggal').value,
                judul: document.getElementById('pengumumanJudul').value,
                isi: document.getElementById('pengumumanIsi').value,
                penting: document.getElementById('pengumumanPenting').checked
            };

            if (!pengumuman.tanggal || !pengumuman.judul || !pengumuman.isi) {
                showToast('Lengkapi semua field!', 'error');
                return;
            }

            if (index === -1) {
                appData.pengumuman.push(pengumuman);
            } else {
                appData.pengumuman[index] = pengumuman;
            }

            await saveData();
            closeModal('modalPengumuman');
            renderPengumumanTable();
            renderDashboard();
        }

        function hapusPengumuman(index) {
            konfirmasiHapus('pengumuman ini', async () => {
                appData.pengumuman.splice(index, 1);
                await saveData();
                renderPengumumanTable();
                renderDashboard();
            });
        }

        // ============================================
        // MODAL UTILITIES
        // ============================================
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function konfirmasiHapus(itemName, callback) {
            document.getElementById('konfirmasiText').textContent = `Apakah Anda yakin ingin menghapus ${itemName}?`;
            document.getElementById('btnKonfirmasiHapus').onclick = async () => {
                closeModal('modalKonfirmasi');
                await callback();
            };
            openModal('modalKonfirmasi');
        }

        // Close modal on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // ============================================
        // UTILITIES
        // ============================================
        function formatRupiah(angka) {
            return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        function formatTanggal(tanggal) {
            const options = { day: 'numeric', month: 'short', year: 'numeric' };
            return new Date(tanggal).toLocaleDateString('id-ID', options);
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }
    </script>
</body>
</html>
    <!-- ============================================
         MODAL: KONFIRMASI HAPUS
    ============================================ -->
    <div class="modal" id="modalKonfirmasi">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i> Konfirmasi Hapus</h3>
                <button class="modal-close" onclick="closeModal('modalKonfirmasi')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="konfirmasiText">Apakah Anda yakin ingin menghapus item ini?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modalKonfirmasi')">Batal</button>
                <button class="btn btn-danger" id="btnKonfirmasiHapus">
                    <i class="fas fa-trash"></i> Hapus
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         TOAST NOTIFICATION
    ============================================ -->
    <div class="toast" id="toast">Berhasil disimpan!</div>

    <!-- ============================================
         LOADING OVERLAY
    ============================================ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
